<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>12 Bubbles</title>
<style>
html, body { margin:0; padding:0; font-family: monospace; height:100vh; background:#0a0a0a; overflow:hidden; color:#0ff; }
#homeScreen { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; }
button { font-size:28px; padding:15px 35px; margin:15px; border:none; border-radius:12px; font-weight:bold; text-transform:uppercase; cursor:pointer; background:linear-gradient(45deg,#00ffff,#00ff99,#ff00ff); color:#fff; box-shadow:0 0 20px #0ff,0 0 40px #0ff; }
#countdown { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); font-size:80px; display:none; }
#scoreContainer { position:fixed; top:20px; left:50%; transform:translateX(-50%); text-align:center; display:none; }
#highscore,#score,#lives{ margin:5px; }
.bubble { width:80px; height:80px; border-radius:50%; display:flex; justify-content:center; align-items:center; font-weight:bold; color:#fff; background:linear-gradient(135deg,#00ffff,#ff00ff); border:2px solid #0ff; position:absolute; cursor:pointer; box-shadow:0 0 15px #0ff inset,0 0 30px #0ff; }
.bubble.rare2x{background:linear-gradient(135deg,#ffff00,#ff9900); color:#000; font-size:28px; }
.bubble.rare144{background:linear-gradient(135deg,#00ff00,#00aa00); color:#000; font-size:28px;}
.bubble.triple{background:linear-gradient(135deg,#ff00ff,#9900ff); color:#fff; font-size:24px;}
#indexPanel{position:fixed;top:100%;left:0;width:100%;background:rgba(10,10,10,0.95);max-height:70%;overflow-y:auto;transition:top 0.3s; padding:20px; z-index:999;}
.indexHeader{display:flex; justify-content:space-between; align-items:center;}
#indexTitle{font-size:24px; text-transform:uppercase;}
#closeIndexBtn{font-size:28px; color:#ff0; cursor:pointer;}
#endScreen{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;flex-direction:column;justify-content:center;align-items:center;color:#0ff;font-size:40px;text-align:center;z-index:1500;}
#versionLabel{position:fixed;top:10px;right:10px;color:rgba(255,255,255,0.3);font-weight:bold;pointer-events:none;}
</style>
</head>
<body>

<div id="homeScreen">
  <div id="versionLabel">Alfa 0.12.3</div>
  <button id="startBtn">START</button>
  <button id="indexBtn">INDEX</button>
</div>

<div id="indexPanel">
  <div class="indexHeader">
    <span id="indexTitle">BUBLINY INDEX</span>
    <span id="closeIndexBtn">✖</span>
  </div>
  <div>Běžná: +1 skóre</div>
  <div>Vzácná 0,25%: Zdvojnásobí skóre (12×2)</div>
  <div>Vzácná 1%: +144 skóre (12²)</div>
  <div>Vzácná 2%: Spawnuje 3 bubliny (3×12)</div>
</div>

<div id="countdown"></div>

<div id="scoreContainer">
  <div id="highscore">Nejvyšší skóre: 0</div>
  <div id="score">Skóre: 0</div>
  <div id="lives">Životy: 3</div>
</div>

<div id="endScreen">
  <div id="finalScoreText"></div>
  <button id="continueBtn">POKRAČOVAT</button>
</div>

<script>
const startBtn=document.getElementById('startBtn');
const indexBtn=document.getElementById('indexBtn');
const homeScreen=document.getElementById('homeScreen');
const indexPanel=document.getElementById('indexPanel');
const closeIndexBtn=document.getElementById('closeIndexBtn');
const countdownEl=document.getElementById('countdown');
const scoreContainer=document.getElementById('scoreContainer');
const scoreEl=document.getElementById('score');
const highscoreEl=document.getElementById('highscore');
const livesEl=document.getElementById('lives');
const endScreen=document.getElementById('endScreen');
const finalScoreText=document.getElementById('finalScoreText');
const continueBtn=document.getElementById('continueBtn');

let score=0, highscore=0, lives=3, bubbles=[], gameRunning=false, startTime;

startBtn.onclick=startCountdown;
indexBtn.onclick=()=>{ indexPanel.style.top='10%'; homeScreen.style.display='none'; };
closeIndexBtn.onclick=()=>{ indexPanel.style.top='100%'; homeScreen.style.display='flex'; };
continueBtn.onclick=()=>{ endScreen.style.display='none'; homeScreen.style.display='flex'; };

indexPanel.addEventListener('click',(e)=>{ if(e.target===indexPanel){ indexPanel.style.top='100%'; homeScreen.style.display='flex'; }});

function startCountdown(){
  homeScreen.style.display='none';
  countdownEl.style.display='block';
  let count=3;
  countdownEl.textContent=count;
  const interval=setInterval(()=>{
    count--;
    if(count>0) countdownEl.textContent=count;
    else{ clearInterval(interval); countdownEl.style.display='none'; scoreContainer.style.display='block'; startGame();}
  },1000);
}

function startGame(){
  score=0; lives=3; bubbles=[]; gameRunning=true; startTime=Date.now();
  scoreEl.textContent="Skóre: "+score; livesEl.textContent="Životy: "+lives;
  spawnBubble();
  requestAnimationFrame(updateBubbles);
}

function spawnBubble(){
  if(!gameRunning) return;
  const elapsed=(Date.now()-startTime)/1000;
  const speedMultiplier=1+elapsed/120;
  const chance=Math.random();
  const bubble=document.createElement('div'); bubble.classList.add('bubble');
  if(chance<=0.0025){ bubble.classList.add('rare2x'); bubble.textContent="12×2"; bubble.dataset.type="2x"; }
  else if(chance<=0.0125){ bubble.classList.add('rare144'); bubble.textContent="12²"; bubble.dataset.type="144"; }
  else if(chance<=0.0325){ bubble.classList.add('triple'); bubble.textContent="3×12"; bubble.dataset.type="triple"; }
  else{ bubble.textContent="12"; bubble.dataset.type="normal"; }

  const size=Math.random()*60+60;
  bubble.style.width=`${size}px`; bubble.style.height=`${size}px`;
  bubble.style.fontSize=(bubble.dataset.type==="144"?size/2.5:size/3)+'px';
  bubble.style.left=Math.random()*(window.innerWidth-size)+'px';
  bubble.style.top=(window.innerHeight-size)+'px';
  bubble.dataset.speed=(Math.random()*1.5+1)*speedMultiplier;
  document.body.appendChild(bubble);

  const pop=()=>{
    if(!gameRunning) return;
    bubble.remove();
    if(bubble.dataset.type==="2x") score*=2;
    else if(bubble.dataset.type==="144") score+=144;
    else if(bubble.dataset.type==="triple") for(let i=0;i<3;i++) spawnSingleBubble();
    else score++;
    scoreEl.textContent="Skóre: "+score;
    if(score>highscore){ highscore=score; highscoreEl.textContent="Nejvyšší skóre: "+highscore; }
    bubbles=bubbles.filter(b=>b!==bubble);
  };

  bubble.addEventListener('click',pop);
  bubbles.push(bubble);
  setTimeout(spawnBubble,500);
}

function spawnSingleBubble(){
  if(!gameRunning) return;
  const bubble=document.createElement('div'); bubble.classList.add('bubble'); bubble.textContent="12"; bubble.dataset.type="normal";
  const size=Math.random()*60+60;
  bubble.style.width=`${size}px`; bubble.style.height=`${size}px`;
  bubble.style.fontSize=size/3+'px';
  bubble.style.left=Math.random()*(window.innerWidth-size)+'px';
  bubble.style.top=(window.innerHeight-size)+'px';
  bubble.dataset.speed=(Math.random()*1.5+1);
  document.body.appendChild(bubble);
  const pop=()=>{ if(!gameRunning) return; score++; scoreEl.textContent="Skóre: "+score; if(score>highscore){ highscore=score; highscoreEl.textContent="Nejvyšší skóre: "+highscore; } bubble.remove(); bubbles=bubbles.filter(b=>b!==bubble);}
  bubble.addEventListener('click',pop);
  bubbles.push(bubble);
}

function updateBubbles(){
  if(!gameRunning) return;
  bubbles.forEach(bubble=>{
    const top=parseFloat(bubble.style.top);
    bubble.style.top=top-parseFloat(bubble.dataset.speed)+'px';
    if(top<=0){ lives--; livesEl.textContent="Životy: "+lives; bubble.remove(); bubbles=bubbles.filter(b=>b!==bubble); if(lives<=0) endGame();}
  });
  requestAnimationFrame(updateBubbles);
}

function endGame(){
  gameRunning=false; bubbles.forEach(b=>b.remove()); bubbles=[];
  scoreContainer.style.display='none';
  finalScoreText.textContent="Tvé skóre: "+score;
  endScreen.style.display='flex';
}
</script>
</body>
</html>
